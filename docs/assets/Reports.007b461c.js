import{j as e}from"./main.ece88e9f.js";import{r as o}from"./react-vendor.36470f4f.js";import{B as p}from"./button.75698c94.js";import{g as k,a as C}from"./api.e91b4448.js";import{x as M,j as L,W as P}from"./ui-lib.676c71c1.js";import{f as z}from"./format.ad2c0b21.js";import"./isValid.f1396d2d.js";function E(){const[a,c]=o.useState([]);return o.useEffect(()=>{(async()=>{try{const t=await k();c(Array.isArray(t==null?void 0:t.health)?t.health:[])}catch(t){console.error("Failed to load health data:",t),c([])}})()},[]),!a||a.length===0?null:e.jsxs("div",{className:"border rounded p-3 bg-white mb-6",children:[e.jsx("div",{className:"font-semibold mb-2",children:"System Health (last 20)"}),e.jsx("ul",{className:"text-sm space-y-1",children:a.map((t,h)=>e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:t.ok?"text-green-600":"text-red-600",children:t.ok?"OK":"ERR"}),e.jsx("span",{className:"text-gray-700",children:t.action}),e.jsx("span",{className:"text-gray-400",children:new Date(t.ts||Date.now()).toLocaleString()})]},h))})]})}function H(){const[a,c]=o.useState([]),[t,h]=o.useState(!0),[y,j]=o.useState(null),[s,w]=o.useState(1),[m,g]=o.useState("all"),d=20;o.useEffect(()=>{(async()=>{try{h(!0),j(null);const l=await C();if(l!=null&&l.reports&&Array.isArray(l.reports)){const n=[...l.reports].sort((b,N)=>new Date(N.updatedTime||N.createdTime)-new Date(b.updatedTime||b.createdTime));c(n)}else throw c([]),new Error("Invalid response format from server")}catch(l){console.error("Error fetching reports:",l),j(l.message||"Failed to load reports"),c([])}finally{h(!1)}})()},[]);const f=s*d,v=f-d;a.slice(v,f);const i=Math.ceil(a.length/d),x=r=>w(r);if(t)return e.jsxs("div",{className:"container mx-auto px-4 py-8 flex flex-col items-center justify-center min-h-[50vh]",children:[e.jsx(M,{className:"h-8 w-8 animate-spin text-blue-600 mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading reports..."})]});const u=a.filter(r=>m==="daily"?/Daily Report/i.test(r.name):m==="weekly"?/Weekly Report/i.test(r.name):!0),R="https://drive.google.com/drive/folders/1BCghnwFPWT1_TZ5Z4nAO13KAIZ2NlDM1";return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Reports"}),e.jsxs("a",{href:R,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-sm text-blue-600 hover:text-blue-800",children:[e.jsx(L,{className:"h-4 w-4 mr-1"}),"Open Reports Folder"]})]}),e.jsx(E,{}),e.jsxs("div",{className:"flex space-x-2 mb-6",children:[e.jsx(p,{variant:m==="all"?"default":"outline",onClick:()=>g("all"),children:"All"}),e.jsx(p,{variant:m==="daily"?"default":"outline",onClick:()=>g("daily"),children:"Daily"}),e.jsx(p,{variant:m==="weekly"?"default":"outline",onClick:()=>g("weekly"),children:"Weekly"})]}),y?e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-yellow-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-yellow-700",children:y.includes("not configured")?"Reports feature is not properly configured.":"No reports available yet. Check back after the first cadence run."})})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md mb-6",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:u.length>0?u.slice((s-1)*d,s*d).map(r=>e.jsx("li",{children:e.jsxs("div",{className:"px-4 py-4 sm:px-6 hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-medium text-blue-600 truncate",children:r.name}),e.jsx("div",{className:"ml-2 flex-shrink-0 flex",children:e.jsx(p,{asChild:!0,variant:"ghost",size:"sm",className:"text-blue-600 hover:text-blue-800",children:e.jsxs("a",{href:r.webViewLink,target:"_blank",rel:"noopener noreferrer",className:"flex items-center",children:[e.jsx("span",{children:"Open"}),e.jsx(P,{className:"ml-1 h-4 w-4"})]})})})]}),e.jsxs("div",{className:"mt-2 sm:flex sm:justify-between",children:[e.jsx("div",{className:"sm:flex",children:e.jsx("p",{className:"flex items-center text-sm text-gray-500",children:r.mimeType})}),e.jsx("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:e.jsxs("p",{children:["Updated ",z(new Date(r.updatedTime),"MMM d, yyyy h:mm a")]})})]})]})},r.id)):e.jsx("li",{className:"px-4 py-4 text-center text-gray-500",children:a.length===0?"No reports found.":"No reports match the current filter."})})}),Math.ceil(u.length/d)>1&&e.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6",children:[e.jsxs("div",{className:"flex flex-1 justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>x(s>1?s-1:1),disabled:s===1,className:"relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),e.jsx("button",{onClick:()=>x(s<i?s+1:i),disabled:s===i,className:"relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:v+1})," to"," ",e.jsx("span",{className:"font-medium",children:f>a.length?a.length:f})," ","of ",e.jsx("span",{className:"font-medium",children:u.length})," results"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[e.jsxs("button",{onClick:()=>x(s>1?s-1:1),disabled:s===1,className:"relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50",children:[e.jsx("span",{className:"sr-only",children:"Previous"}),e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z",clipRule:"evenodd"})})]}),Array.from({length:Math.min(5,i)},(r,l)=>{let n;return i<=5||s<=3?n=l+1:s>=i-2?n=i-4+l:n=s-2+l,e.jsx("button",{onClick:()=>x(n),className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ${s===n?"z-10 bg-blue-600 text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:outline-offset-0"}`,children:n},n)}),e.jsxs("button",{onClick:()=>x(s<i?s+1:i),disabled:s===i,className:"relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50",children:[e.jsx("span",{className:"sr-only",children:"Next"}),e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z",clipRule:"evenodd"})})]})]})})]})]})]})]})})}export{H as default};
//# sourceMappingURL=Reports.007b461c.js.map
