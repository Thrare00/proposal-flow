const c="https://proposal-flow.rareearthcontracting.workers.dev",i="https://script.google.com/macros/s/AKfycbyYhYWfVMNqIUlYgwlT8_Sv3ZPXze_EyBzdpjbGwk45Qemjw3GcHT7rSqI1i1zLjS4/exec",d=c,w="https://proposal-flow.rareearthcontracting.workers.dev/",f="1BCghnwFPWT1_TZ5Z4nAO13KAIZ2NlDM1";typeof window<"u"&&!window.__PF_ENDPOINTS_LOGGED__&&(window.__PF_ENDPOINTS_LOGGED__=!0,console.log("[PF] Endpoints:",{GAS_PROXY:"https://proposal-flow.rareearthcontracting.workers.dev",GAS_URL:"https://script.google.com/macros/s/AKfycbyYhYWfVMNqIUlYgwlT8_Sv3ZPXze_EyBzdpjbGwk45Qemjw3GcHT7rSqI1i1zLjS4/exec",GAS_RESOLVED:d,HEALTH_RESOLVED:w,QUEUE_URL:typeof import.meta<"u"&&{VITE_BASE_URL:"/proposal-flow/",VITE_QUEUE_URL:"https://proposal-flow.rareearthcontracting.workers.dev/",VITE_GAS_URL:"https://script.google.com/macros/s/AKfycbyYhYWfVMNqIUlYgwlT8_Sv3ZPXze_EyBzdpjbGwk45Qemjw3GcHT7rSqI1i1zLjS4/exec",VITE_HEALTH_URL:"https://proposal-flow.rareearthcontracting.workers.dev/",VITE_GAS_PROXY:"https://proposal-flow.rareearthcontracting.workers.dev",VITE_REPORTS_FOLDER_ID:"1BCghnwFPWT1_TZ5Z4nAO13KAIZ2NlDM1",BASE_URL:"/proposal-flow/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"https://proposal-flow.rareearthcontracting.workers.dev/"}));async function _(e,r){const t=await fetch(e,{...r,credentials:"omit",headers:{Accept:"application/json",...(r==null?void 0:r.headers)||{}}}),s=t.headers.get("content-type")||"";if(!t.ok){const o=await t.text().catch(()=>"");if(o.trim().startsWith("<!DOCTYPE")||o.trim().startsWith("<html"))throw new Error(`Upstream returned HTML (${t.status}). Snippet: ${o.slice(0,160)}`);try{if(o&&(s.includes("json")||o.trim().startsWith("{")||o.trim().startsWith("["))){const h=JSON.parse(o);throw new Error(`${t.status} ${t.statusText} — ${JSON.stringify(h).slice(0,200)}`)}}catch{}throw new Error(`${t.status} ${t.statusText} — ${o.slice(0,200)}`)}if(s.includes("json"))return await t.json();const a=(await t.text()).trim();if(a.startsWith("{")||a.startsWith("["))try{return JSON.parse(a)}catch{}throw new Error(`Failed to parse JSON response. Content-Type: ${s||"n/a"}. Snippet: ${a.slice(0,200)}`)}async function l(e,r){let t;for(const s of e.filter(Boolean))try{return await _(s,r)}catch(n){t=n}throw t||new Error("No valid endpoints configured")}async function p(e,r=3,t=600){let s;for(let n=0;n<r;n++)try{return await e()}catch(a){s=a,n<r-1&&await new Promise(o=>setTimeout(o,t*(n+1)))}throw s}async function E(){const e=[`${w}?fn=getHealth`,`${i}?fn=getHealth`];return p(()=>l(e))}async function u(){const e=[`${c}?fn=getCadence`,`${i}?fn=getCadence`];return p(()=>l(e))}async function S(e){const r=[`${c}?fn=setCadence`,`${i}?fn=setCadence`];return p(()=>l(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}))}async function g(){const e=[`${c}?fn=getReports&folderId=${encodeURIComponent(f)}`,`${i}?fn=getReports&folderId=${encodeURIComponent(f)}`];return p(()=>l(e))}export{g as a,u as b,E as g,S as s};
//# sourceMappingURL=api.04a6af5e.js.map
