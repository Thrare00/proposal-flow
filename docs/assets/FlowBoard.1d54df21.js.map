{"version":3,"file":"FlowBoard.1d54df21.js","sources":["../../src/pages/FlowBoard.jsx"],"sourcesContent":["import React, { useState, useEffect, useMemo, useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useProposalContext } from '../contexts/ProposalContext.jsx';\nimport { format, parseISO, isAfter, isBefore, addDays } from 'date-fns';\nimport { getStatusName, getUrgencyLevel } from '../utils/statusUtils.js';\nimport { enqueue } from '../lib/enqueue.js';\nimport { CheckCircle, ChevronRight, Upload, FileText, AlertTriangle } from 'lucide-react';\n\n// Stage configuration with progression and actions\n// Enhanced color scheme with better contrast and accessibility\n// Enhanced color scheme with better contrast and accessibility\nconst STAGES = [\n  {\n    id: 'intake',\n    name: 'Intake',\n    next: 'outline',\n    // Card container styles\n    container: 'bg-blue-50 dark:bg-blue-900/10 border-l-4 border-blue-400 dark:border-blue-500',\n    // Header styles\n    header: 'bg-blue-700 dark:bg-blue-800 text-white',\n    // Content styles\n    content: 'bg-white/80 dark:bg-gray-800/80',\n    // Action button styles\n    primaryAction: 'bg-blue-600 hover:bg-blue-700 text-white',\n    secondaryAction: 'bg-white hover:bg-gray-50 text-gray-700 border border-gray-300 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 dark:hover:bg-gray-600',\n    // Text colors\n    text: 'text-gray-800 dark:text-gray-100',\n    // Status indicator\n    status: 'text-blue-700 dark:text-blue-400',\n    actions: [\n      { \n        id: 'log_pipeline', \n        label: 'Log to Pipeline', \n        icon: CheckCircle,\n        variant: 'primary'\n      },\n      { \n        id: 'upload_docs', \n        label: 'Upload Docs', \n        icon: Upload,\n        variant: 'secondary'\n      }\n    ]\n  },\n  {\n    id: 'outline',\n    name: 'Outline',\n    next: 'drafting',\n    container: 'bg-purple-50 dark:bg-purple-900/10 border-l-4 border-purple-400 dark:border-purple-500',\n    header: 'bg-purple-700 dark:bg-purple-800 text-white',\n    content: 'bg-white/80 dark:bg-gray-800/80',\n    primaryAction: 'bg-purple-600 hover:bg-purple-700 text-white',\n    secondaryAction: 'bg-white hover:bg-gray-50 text-gray-700 border border-gray-300 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 dark:hover:bg-gray-600',\n    text: 'text-gray-800 dark:text-gray-100',\n    status: 'text-purple-700 dark:text-purple-400',\n    actions: [\n      { \n        id: 'create_outline', \n        label: 'Create Outline', \n        icon: FileText,\n        variant: 'primary'\n      },\n      { \n        id: 'upload_docs', \n        label: 'Upload Docs', \n        icon: Upload,\n        variant: 'secondary'\n      }\n    ]\n  },\n  {\n    id: 'drafting',\n    name: 'Drafting',\n    next: 'internal_review',\n    container: 'bg-amber-50 dark:bg-amber-900/10 border-l-4 border-amber-400 dark:border-amber-500',\n    header: 'bg-amber-600 dark:bg-amber-700 text-gray-900 dark:text-white',\n    content: 'bg-white/80 dark:bg-gray-800/80',\n    primaryAction: 'bg-amber-600 hover:bg-amber-700 text-gray-900 dark:text-white',\n    secondaryAction: 'bg-white hover:bg-gray-50 text-gray-700 border border-gray-300 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 dark:hover:bg-gray-600',\n    text: 'text-gray-800 dark:text-gray-100',\n    status: 'text-amber-700 dark:text-amber-400',\n    actions: [\n      { \n        id: 'start_draft', \n        label: 'Start Draft', \n        icon: FileText,\n        variant: 'primary'\n      },\n      { \n        id: 'upload_draft', \n        label: 'Upload Draft', \n        icon: Upload,\n        variant: 'secondary'\n      }\n    ]\n  },\n  {\n    id: 'internal_review',\n    name: 'Internal Review',\n    next: 'final_review',\n    container: 'bg-orange-50 dark:bg-orange-900/10 border-l-4 border-orange-400 dark:border-orange-500',\n    header: 'bg-orange-600 dark:bg-orange-700 text-white',\n    content: 'bg-white/80 dark:bg-gray-800/80',\n    primaryAction: 'bg-orange-600 hover:bg-orange-700 text-white',\n    secondaryAction: 'bg-white hover:bg-gray-50 text-gray-700 border border-gray-300 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 dark:hover:bg-gray-600',\n    text: 'text-gray-800 dark:text-gray-100',\n    status: 'text-orange-700 dark:text-orange-400',\n    actions: [\n      { \n        id: 'request_review', \n        label: 'Request Review', \n        icon: AlertTriangle,\n        variant: 'primary'\n      },\n      { \n        id: 'upload_feedback', \n        label: 'Upload Feedback', \n        icon: Upload,\n        variant: 'secondary'\n      }\n    ]\n  },\n  {\n    id: 'final_review',\n    name: 'Final Review',\n    next: 'submitted',\n    container: 'bg-emerald-50 dark:bg-emerald-900/10 border-l-4 border-emerald-400 dark:border-emerald-500',\n    header: 'bg-emerald-700 dark:bg-emerald-800 text-white',\n    content: 'bg-white/80 dark:bg-gray-800/80',\n    primaryAction: 'bg-emerald-600 hover:bg-emerald-700 text-white',\n    secondaryAction: 'bg-white hover:bg-gray-50 text-gray-700 border border-gray-300 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 dark:hover:bg-gray-600',\n    text: 'text-gray-800 dark:text-gray-100',\n    status: 'text-emerald-700 dark:text-emerald-400',\n    actions: [\n      { \n        id: 'finalize', \n        label: 'Finalize', \n        icon: CheckCircle,\n        variant: 'primary'\n      },\n      { \n        id: 'upload_final', \n        label: 'Upload Final', \n        icon: Upload,\n        variant: 'secondary'\n      }\n    ]\n  },\n  {\n    id: 'submitted',\n    name: 'Submitted',\n    next: null,\n    container: 'bg-gray-50 dark:bg-gray-800/30 border-l-4 border-gray-400 dark:border-gray-600',\n    header: 'bg-gray-600 dark:bg-gray-700 text-white',\n    content: 'bg-white/80 dark:bg-gray-800/80',\n    primaryAction: 'bg-gray-600 hover:bg-gray-700 text-white',\n    secondaryAction: 'bg-white hover:bg-gray-50 text-gray-700 border border-gray-300 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 dark:hover:bg-gray-600',\n    text: 'text-gray-700 dark:text-gray-200',\n    status: 'text-gray-600 dark:text-gray-400',\n    actions: []\n  }\n];\n\nfunction FlowBoard() {\n  const navigate = useNavigate();\n  const { proposals = [], fetchProposals } = useProposalContext();\n  const [search, setSearch] = useState('');\n  const [agencyFilter, setAgencyFilter] = useState('');\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const [error, setError] = useState(null);\n  const [isProcessing, setIsProcessing] = useState({});\n\n  // Fetch proposals on component mount\n  useEffect(() => {\n    if (fetchProposals) {\n      const loadData = async () => {\n        try {\n          setIsRefreshing(true);\n          await fetchProposals();\n          setError(null);\n        } catch (err) {\n          console.error('Error fetching proposals:', err);\n          setError('Failed to load proposals. Please try again.');\n        } finally {\n          setIsRefreshing(false);\n        }\n      };\n      \n      loadData();\n    }\n  }, [fetchProposals]);\n\n  // Get unique agencies for filter dropdown\n  const agencies = useMemo(() => {\n    const agencySet = new Set(proposals.map(p => p.agency).filter(Boolean));\n    return Array.from(agencySet).sort();\n  }, [proposals]);\n\n  // Filter proposals based on search and agency filter\n  const filteredProposals = useMemo(() => {\n    let result = [...proposals];\n    \n    if (search.trim()) {\n      const searchLower = search.toLowerCase();\n      result = result.filter(p => \n        (p.title || '').toLowerCase().includes(searchLower) ||\n        (p.agency || '').toLowerCase().includes(searchLower)\n      );\n    }\n    \n    if (agencyFilter) {\n      result = result.filter(p => p.agency === agencyFilter);\n    }\n    \n    return result;\n  }, [proposals, search, agencyFilter]);\n\n  // Helper functions\n  const isDueSoon = useCallback((dueDate) => {\n    if (!dueDate) return false;\n    const date = typeof dueDate === 'string' ? parseISO(dueDate) : dueDate;\n    const today = new Date();\n    const weekFromNow = addDays(today, 7);\n    return isAfter(date, today) && isBefore(date, weekFromNow);\n  }, []);\n  \n  const isOverdue = useCallback((dueDate) => {\n    if (!dueDate) return false;\n    const date = typeof dueDate === 'string' ? parseISO(dueDate) : dueDate;\n    return isBefore(date, new Date());\n  }, []);\n\n  // Group proposals by status with enhanced data\n  const proposalsByStatus = useMemo(() => {\n    const grouped = {};\n    STAGES.forEach(stage => {\n      grouped[stage.id] = filteredProposals\n        .filter(p => p.status === stage.id)\n        .map(proposal => ({\n          ...proposal,\n          isDueSoon: isDueSoon(proposal.dueDate),\n          isOverdue: isOverdue(proposal.dueDate),\n          urgency: getUrgencyLevel(proposal.dueDate)\n        }));\n    });\n    return grouped;\n  }, [filteredProposals, isDueSoon, isOverdue]);\n\n  // Function to handle proposal actions\n  const handleAction = useCallback(async (action, proposalId, currentStage) => {\n    const actionId = `${action}-${proposalId}`;\n    try {\n      setIsProcessing(prev => ({ ...prev, [actionId]: true }));\n      setError(null);\n      \n      // Find the current stage and next stage\n      const currentStageObj = STAGES.find(s => s.id === currentStage);\n      \n      // Handle different actions\n      switch (action) {\n        case 'start_draft':\n        case 'create_outline':\n        case 'request_review':\n        case 'finalize':\n          // These actions just update the status to the next stage\n          if (currentStageObj?.next) {\n            await fetch(`/api/proposals/${proposalId}`, {\n              method: 'PATCH',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ status: currentStageObj.next })\n            });\n          }\n          break;\n          \n        case 'log_pipeline':\n          // Handle pipeline logging\n          await fetch(`/api/proposals/${proposalId}/log`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ action: 'log_pipeline' })\n          });\n          break;\n          \n        case 'upload_docs':\n        case 'upload_draft':\n        case 'upload_feedback':\n        case 'upload_final':\n          // Handle file uploads - this is a placeholder, actual implementation would use a file input\n          const fileInput = document.createElement('input');\n          fileInput.type = 'file';\n          fileInput.onchange = async (e) => {\n            const file = e.target.files[0];\n            if (!file) return;\n            \n            const formData = new FormData();\n            formData.append('file', file);\n            formData.append('action', action);\n            \n            await fetch(`/api/proposals/${proposalId}/upload`, {\n              method: 'POST',\n              body: formData\n            });\n            \n            // Refresh data after upload\n            await fetchProposals();\n          };\n          fileInput.click();\n          break;\n          \n        case 'next_stage':\n        default:\n          // Default action: move to next stage\n          if (currentStageObj?.next) {\n            await fetch(`/api/proposals/${proposalId}`, {\n              method: 'PATCH',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ status: currentStageObj.next })\n            });\n          }\n          break;\n      }\n      \n      // Refresh data after action\n      await fetchProposals();\n      \n    } catch (err) {\n      console.error(`Error in ${action}:`, err);\n      setError(`Failed to ${action.replace('_', ' ')}. Please try again.`);\n    } finally {\n      setIsProcessing(prev => ({ ...prev, [actionId]: false }));\n    }\n  }, [fetchProposals]);\n  \n  const handleCardClick = useCallback((id) => {\n    navigate(`/proposals/${id}`);\n  }, [navigate]);\n  \n\n  const handleRefresh = useCallback(async () => {\n    if (!fetchProposals) return;\n    try {\n      setIsRefreshing(true);\n      await fetchProposals();\n      setError(null);\n    } catch (err) {\n      console.error('Error refreshing proposals:', err);\n      setError('Failed to refresh proposals. Please try again.');\n    } finally {\n      setIsRefreshing(false);\n    }\n  }, [fetchProposals]);\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50 p-4\">\n        <div className=\"max-w-md w-full bg-white rounded-xl shadow-lg overflow-hidden\">\n          <div className=\"bg-red-50 px-6 py-4 border-b border-red-100\">\n            <h2 className=\"text-lg font-medium text-red-800\">Error Loading Proposals</h2>\n          </div>\n          <div className=\"p-6\">\n            <p className=\"text-gray-700 mb-4\">{error}</p>\n            <button\n              onClick={handleRefresh}\n              className=\"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600\"\n              disabled={isRefreshing}\n            >\n              {isRefreshing ? 'Retrying...' : 'Retry'}\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-4\">\n      <div className=\"flex justify-between items-center mb-4\">\n        <h1 className=\"text-2xl font-bold\">Proposal Flow Board</h1>\n        <button \n          onClick={handleRefresh}\n          className=\"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600\"\n          disabled={isRefreshing}\n        >\n          {isRefreshing ? 'Refreshing...' : 'Refresh'}\n        </button>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6\">\n        <div>\n          <label className=\"block text-sm font-medium mb-1\">Search</label>\n          <input\n            type=\"text\"\n            value={search}\n            onChange={(e) => setSearch(e.target.value)}\n            className=\"w-full p-2 border rounded\"\n            placeholder=\"Search proposals...\"\n          />\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium mb-1\">Filter by Agency</label>\n          <select\n            value={agencyFilter}\n            onChange={(e) => setAgencyFilter(e.target.value)}\n            className=\"w-full p-2 border rounded\"\n          >\n            <option value=\"\">All Agencies</option>\n            {agencies.map(agency => (\n              <option key={agency} value={agency}>\n                {agency}\n              </option>\n            ))}\n          </select>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4 overflow-x-auto pb-4\">\n        {STAGES.map(stage => {\n          const proposals = proposalsByStatus[stage.id] || [];\n          const stageProposals = proposals.filter(p => \n            !search || \n            (p.title && p.title.toLowerCase().includes(search.toLowerCase())) ||\n            (p.agency && p.agency.toLowerCase().includes(search.toLowerCase()))\n          );\n          \n          return (\n            <div \n              key={stage.id} \n              className={`rounded-lg overflow-hidden min-w-[300px] ${stage.container} shadow-md hover:shadow-lg transition-all duration-200`}\n            >\n              <div className={`flex justify-between items-center px-4 py-3 ${stage.header} ${stage.text}`}>\n                <h3 className=\"font-semibold text-sm uppercase tracking-wider\">\n                  {stage.name}\n                </h3>\n                <span className=\"text-xs font-bold px-2.5 py-1 rounded-full bg-black/10 dark:bg-white/20\">\n                  {stageProposals.length}\n                </span>\n              </div>\n              \n              <div className=\"space-y-3\">\n                {stageProposals.map(proposal => {\n                  const actionId = `next-${proposal.id}`;\n                  const isProcessingAction = isProcessing[actionId];\n                  const dueDate = proposal.dueDate ? new Date(proposal.dueDate) : null;\n                  \n                  return (\n                    <div\n                      key={proposal.id}\n                      className={`rounded-lg shadow-sm hover:shadow-md transition-all duration-200 overflow-hidden ${\n                        stage.content\n                      } ${\n                        proposal.urgency === 'high' ? 'ring-1 ring-amber-500/30' : ''\n                      }`}\n                    >\n                      <div \n                        className=\"p-3 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors\"\n                        onClick={() => handleCardClick(proposal.id)}\n                      >\n                        <div className=\"flex justify-between items-start\">\n                          <h4 className={`font-medium line-clamp-2 text-sm leading-snug ${stage.text}`}>\n                            {proposal.title || 'Untitled'}\n                          </h4>\n                          {proposal.urgency === 'high' && (\n                            <span className=\"ml-2 flex-shrink-0 inline-flex items-center px-2 py-0.5 rounded text-[10px] font-semibold bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-200\">\n                              Urgent\n                            </span>\n                          )}\n                        </div>\n\n                        {proposal.agency && (\n                          <p className=\"text-xs text-gray-600 dark:text-gray-300 mt-1 truncate\">\n                            {proposal.agency}\n                          </p>\n                        )}\n\n                        {dueDate && (\n                          <div className={`mt-2 flex items-center text-xs font-medium ${\n                            proposal.isOverdue\n                              ? 'text-red-600 dark:text-red-400'\n                              : proposal.isDueSoon\n                                ? 'text-amber-600 dark:text-amber-400'\n                                : 'text-gray-500 dark:text-gray-400'\n                          }`}>\n                            <span className={`inline-block w-2 h-2 rounded-full mr-1.5 ${\n                              proposal.isOverdue\n                                ? 'bg-red-500'\n                                : proposal.isDueSoon\n                                  ? 'bg-amber-400'\n                                  : 'bg-gray-400'\n                            }`} />\n                            {proposal.isOverdue ? 'Overdue: ' : 'Due: '}\n                            {format(dueDate, 'MMM d, yyyy')}\n                          </div>\n                        )}\n                      </div>\n                      <div className=\"border-t border-gray-100 dark:border-gray-700/50 p-2 bg-gray-50/50 dark:bg-gray-800/50\">\n                        <div className=\"flex justify-between items-center space-x-2\">\n                          {/* Stage Actions */}\n                          <div className=\"flex-1 flex space-x-1 overflow-x-auto pb-1\">\n                            {stage.actions.map(action => (\n                              <button\n                                key={action.id}\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  handleAction(action.id, proposal.id, stage.id);\n                                }}\n                                disabled={isProcessing[`${action.id}-${proposal.id}`]}\n                                className={`flex items-center px-2 py-1 text-xs rounded-md transition-colors whitespace-nowrap ${\n                                  action.variant === 'primary' \n                                    ? stage.primaryAction \n                                    : stage.secondaryAction\n                                } ${\n                                  isProcessing[`${action.id}-${proposal.id}`] ? 'opacity-70 cursor-not-allowed' : ''\n                                }`}\n                              >\n                                <action.icon className=\"w-3 h-3 mr-1\" />\n                                {action.label}\n                              </button>\n                            ))}\n                          </div>\n                          \n                          {/* Next Stage Button */}\n                          {stage.next && (\n                            <button\n                              onClick={(e) => {\n                                e.stopPropagation();\n                                handleAction('next_stage', proposal.id, stage.id);\n                              }}\n                              disabled={isProcessing[`next-${proposal.id}`]}\n                              className={`p-1.5 rounded-full border transition-colors ${\n                                isProcessing[`next-${proposal.id}`]\n                                  ? 'bg-gray-100 dark:bg-gray-700 text-gray-400 border-gray-200 dark:border-gray-600'\n                                  : 'bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600 text-emerald-600 dark:text-emerald-400 hover:bg-emerald-50 dark:hover:bg-emerald-900/30 hover:border-emerald-300 dark:hover:border-emerald-700'\n                              }`}\n                              title={`Move to ${STAGES.find(s => s.id === stage.next)?.name || 'next stage'}`}\n                            >\n                              {isProcessing[`next-${proposal.id}`] ? (\n                                <svg className=\"animate-spin h-3.5 w-3.5\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                                  <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                                  <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                                </svg>\n                              ) : (\n                                <ChevronRight className=\"h-3.5 w-3.5\" />\n                              )}\n                            </button>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                  );\n                })}\n                \n                {stageProposals.length === 0 && (\n                  <div className=\"text-center py-6 text-sm text-gray-400 dark:text-gray-500 bg-white/30 dark:bg-gray-800/30 rounded-lg border border-dashed border-gray-200 dark:border-gray-700\">\n                    <div className=\"flex flex-col items-center justify-center p-2\">\n                      <FileText className=\"w-5 h-5 text-gray-300 dark:text-gray-600 mb-1\" />\n                      <p className=\"text-xs\">No {stage.name.toLowerCase()} items</p>\n                      <p className=\"text-2xs text-gray-400 dark:text-gray-500 mt-1\">\n                        {stage.id === 'intake' ? 'Add a new proposal to get started' : 'Drag items here or use actions'}\n                      </p>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n\nexport default FlowBoard;\n"],"names":["STAGES","CheckCircle","Upload","FileText","AlertTriangle","FlowBoard","navigate","useNavigate","proposals","fetchProposals","useProposalContext","search","setSearch","useState","agencyFilter","setAgencyFilter","isRefreshing","setIsRefreshing","error","setError","isProcessing","setIsProcessing","useEffect","err","agencies","useMemo","agencySet","p","filteredProposals","result","searchLower","isDueSoon","useCallback","dueDate","date","parseISO","today","weekFromNow","addDays","isAfter","isBefore","isOverdue","proposalsByStatus","grouped","stage","proposal","getUrgencyLevel","handleAction","action","proposalId","currentStage","actionId","prev","currentStageObj","s","fileInput","e","file","formData","handleCardClick","id","handleRefresh","jsxs","jsx","agency","stageProposals","format","_a","ChevronRight"],"mappings":"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"}