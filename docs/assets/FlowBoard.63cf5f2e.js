import{a as N,j as e}from"./main.7e5e4b3c.js";import{u as w,r as l}from"./react-vendor.36470f4f.js";import{c as S}from"./statusUtils.42174679.js";import{f as C}from"./format.ad2c0b21.js";import{p as k}from"./parseISO.585b4435.js";import"./isValid.f1396d2d.js";const g=["intake","outline","drafting","internal_review","final_review","submitted"];function M(){const u=w(),{proposals:o=[],fetchProposals:t}=N(),[i,p]=l.useState(""),[n,b]=l.useState(""),[c,d]=l.useState(!1),[h,m]=l.useState(null);l.useEffect(()=>{t&&(async()=>{try{d(!0),await t(),m(null)}catch(r){console.error("Error fetching proposals:",r),m("Failed to load proposals. Please try again.")}finally{d(!1)}})()},[t]);const y=l.useMemo(()=>{const s=new Set(o.map(r=>r.agency).filter(Boolean));return Array.from(s).sort()},[o]),x=l.useMemo(()=>{let s=[...o];if(i.trim()){const r=i.toLowerCase();s=s.filter(a=>(a.title||"").toLowerCase().includes(r)||(a.agency||"").toLowerCase().includes(r))}return n&&(s=s.filter(r=>r.agency===n)),s},[o,i,n]),j=l.useMemo(()=>{const s={};return g.forEach(r=>{s[r]=x.filter(a=>a.status===r)}),s},[x]),v=l.useCallback(s=>{u(`/proposals/${s}`)},[u]),f=l.useCallback(async()=>{if(t)try{d(!0),await t(),m(null)}catch(s){console.error("Error refreshing proposals:",s),m("Failed to refresh proposals. Please try again.")}finally{d(!1)}},[t]);return h?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"bg-red-50 px-6 py-4 border-b border-red-100",children:e.jsx("h2",{className:"text-lg font-medium text-red-800",children:"Error Loading Proposals"})}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-700 mb-4",children:h}),e.jsx("button",{onClick:f,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",disabled:c,children:c?"Retrying...":"Retry"})]})]})}):e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Proposal Flow Board"}),e.jsx("button",{onClick:f,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",disabled:c,children:c?"Refreshing...":"Refresh"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Search"}),e.jsx("input",{type:"text",value:i,onChange:s=>p(s.target.value),className:"w-full p-2 border rounded",placeholder:"Search proposals..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Filter by Agency"}),e.jsxs("select",{value:n,onChange:s=>b(s.target.value),className:"w-full p-2 border rounded",children:[e.jsx("option",{value:"",children:"All Agencies"}),y.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:g.map(s=>{var r;return e.jsxs("div",{className:"border rounded p-4",children:[e.jsx("div",{className:"font-bold mb-2",children:S(s)}),e.jsx("div",{className:"space-y-2",children:(r=j[s])==null?void 0:r.map(a=>e.jsxs("div",{onClick:()=>v(a.id),className:"p-3 border rounded cursor-pointer hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"font-medium",children:a.title||"Untitled"}),e.jsx("div",{className:"text-sm text-gray-600",children:a.agency}),a.dueDate&&e.jsxs("div",{className:"text-xs mt-1",children:["Due: ",C(k(a.dueDate),"MMM d, yyyy")]})]},a.id))})]},s)})})]})}export{M as default};
//# sourceMappingURL=FlowBoard.63cf5f2e.js.map
