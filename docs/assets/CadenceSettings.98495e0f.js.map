{"version":3,"file":"CadenceSettings.98495e0f.js","sources":["../../src/pages/CadenceSettings.jsx"],"sourcesContent":["import React, { useEffect, useState, useMemo, useRef } from \"react\";\nimport { toast } from \"react-toastify\";\nimport { setCadence, getHealth, getCadence } from \"../lib/api.js\";\nimport { Clock, Info, AlertTriangle } from \"lucide-react\";\nimport { createPortal } from \"react-dom\";\n\n// Confirmation Dialog Component\nconst ConfirmDialog = ({ isOpen, onConfirm, onCancel, title, message, confirmText = \"Confirm\", cancelText = \"Cancel\" }) => {\n  if (!isOpen) return null;\n  \n  const dialogRef = useRef(null);\n  \n  // Close on Escape key\n  useEffect(() => {\n    const handleKeyDown = (e) => {\n      if (e.key === 'Escape') onCancel();\n      if (e.key === 'Enter' && e.ctrlKey) onConfirm();\n    };\n    \n    \n    document.addEventListener('keydown', handleKeyDown);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [onConfirm, onCancel]);\n  \n  // Focus trap\n  useEffect(() => {\n    if (isOpen && dialogRef.current) {\n      const focusable = dialogRef.current.querySelectorAll('button');\n      if (focusable.length > 0) focusable[0].focus();\n    }\n  }, [isOpen]);\n  \n  return createPortal(\n    <div \n      className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\"\n      role=\"dialog\"\n      aria-modal=\"true\"\n      aria-labelledby=\"dialog-title\"\n    >\n      <div \n        ref={dialogRef}\n        className=\"bg-white rounded-lg shadow-xl max-w-md w-full p-6\"\n        onKeyDown={(e) => e.stopPropagation()}\n      >\n        <div className=\"flex items-start\">\n          <div className=\"flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:h-10 sm:w-10\">\n            <AlertTriangle className=\"h-6 w-6 text-red-600\" aria-hidden=\"true\" />\n          </div>\n          <div className=\"ml-4\">\n            <h3 id=\"dialog-title\" className=\"text-lg font-medium text-gray-900\">\n              {title}\n            </h3>\n            <div className=\"mt-2\">\n              <p className=\"text-sm text-gray-500\">{message}</p>\n            </div>\n          </div>\n        </div>\n        <div className=\"mt-5 sm:mt-6 sm:grid sm:grid-cols-2 sm:gap-3 sm:grid-flow-row-dense\">\n          <button\n            type=\"button\"\n            onClick={onConfirm}\n            className=\"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:col-start-2 sm:text-sm\"\n            autoFocus\n          >\n            {confirmText}\n          </button>\n          <button\n            type=\"button\"\n            onClick={onCancel}\n            className=\"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:col-start-1 sm:text-sm\"\n          >\n            {cancelText}\n          </button>\n        </div>\n      </div>\n    </div>,\n    document.body\n  );\n};\n\nconst ALL_DAYS = [\"MON\", \"TUE\", \"WED\", \"THU\", \"FRI\", \"SAT\", \"SUN\"];\n\n// Common timezones for better UX with user-friendly display names\nconst COMMON_TIMEZONES = [\n  { value: \"America/New_York\", label: \"Eastern Time (US & Canada)\" },\n  { value: \"America/Chicago\", label: \"Central Time (US & Canada)\" },\n  { value: \"America/Denver\", label: \"Mountain Time (US & Canada)\" },\n  { value: \"America/Los_Angeles\", label: \"Pacific Time (US & Canada)\" },\n  { value: \"America/Phoenix\", label: \"Arizona\" },\n  { value: \"America/Anchorage\", label: \"Alaska\" },\n  { value: \"America/Adak\", label: \"Hawaii-Aleutian\" },\n  { value: \"Pacific/Honolulu\", label: \"Hawaii\" }\n];\n\n// Helper to format timezone offset\nconst formatOffset = (date) => {\n  const offset = -date.getTimezoneOffset();\n  const hours = Math.floor(Math.abs(offset) / 60);\n  const minutes = Math.abs(offset) % 60;\n  const sign = offset >= 0 ? '+' : '-';\n  return `UTC${sign}${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}`;\n};\n\n// Helper to get timezone display name\nconst getTimezoneDisplayName = (timezone) => {\n  try {\n    const commonTz = COMMON_TIMEZONES.find(tz => tz.value === timezone);\n    if (commonTz) return commonTz.label;\n    \n    const date = new Date();\n    const options = { \n      timeZone: timezone, \n      timeZoneName: 'long',\n      timeStyle: 'long',\n      hour12: false\n    };\n    const formatted = new Intl.DateTimeFormat('en-US', options)\n      .formatToParts(date)\n      .find(part => part.type === 'timeZoneName')?.value || timezone;\n    \n    return formatted;\n  } catch (e) {\n    return timezone;\n  }\n};\n\nexport default function CadenceSettings() {\n  const [days, setDays] = useState([\"MON\", \"WED\"]);\n  const [time, setTime] = useState(\"09:00\");\n  const [tz, setTz] = useState(() => Intl.DateTimeFormat().resolvedOptions().timeZone);\n  const [customTz, setCustomTz] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(true);\n  const [isSaving, setIsSaving] = useState(false);\n  const [lastProcessed, setLastProcessed] = useState(null);\n  const [currentTime, setCurrentTime] = useState(new Date());\n  const [showConfirm, setShowConfirm] = useState(false);\n  const [formData, setFormData] = useState(null);\n  const formRef = useRef(null);\n  const lastFocusedElement = useRef(null);\n  \n  // Update current time every second\n  useEffect(() => {\n    const timer = setInterval(() => setCurrentTime(new Date()), 1000);\n    return () => clearInterval(timer);\n  }, []);\n  \n  // Format current time in selected timezone\n  const currentTimeInTz = useMemo(() => {\n    try {\n      return new Intl.DateTimeFormat('en-US', {\n        timeZone: tz,\n        hour: '2-digit',\n        minute: '2-digit',\n        second: '2-digit',\n        hour12: false\n      }).format(currentTime);\n    } catch (e) {\n      return 'Invalid timezone';\n    }\n  }, [tz, currentTime]);\n  \n  // Get timezone offset for display\n  const timezoneOffset = useMemo(() => {\n    try {\n      const date = new Date();\n      const tzDate = new Date(date.toLocaleString('en-US', { timeZone: tz }));\n      return formatOffset(tzDate);\n    } catch (e) {\n      return '';\n    }\n  }, [tz]);\n\n  // Load existing cadence settings\n  useEffect(() => {\n    const loadSettings = async () => {\n      setIsLoading(true);\n      try {\n        const [cadence, health] = await Promise.all([\n          getCadence().catch(() => ({})), // Gracefully handle if not implemented\n          getHealth().catch(() => ({}))  // Gracefully handle if not available\n        ]);\n\n        if (cadence.days) setDays(cadence.days);\n        if (cadence.time) setTime(cadence.time);\n        if (cadence.tz) {\n          setTz(cadence.tz);\n          if (!COMMON_TIMEZONES.includes(cadence.tz)) {\n            setCustomTz(cadence.tz);\n          }\n        }\n        if (health?.last_processed?.timestamp) {\n          setLastProcessed(new Date(health.last_processed.timestamp));\n        }\n      } catch (error) {\n        console.error('Failed to load settings:', error);\n        toast.error('Failed to load settings. Please refresh the page.');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    loadSettings();\n  }, []);\n\n  const toggleDay = (day) => {\n    setDays(prev => {\n      const newDays = prev.includes(day)\n        ? prev.filter(d => d !== day)\n        : [...prev, day].sort((a, b) => ALL_DAYS.indexOf(a) - ALL_DAYS.indexOf(b));\n      return newDays;\n    });\n  };\n\n  const handleTimezoneChange = (e) => {\n    const value = e.target.value;\n    if (value === 'custom') {\n      setTz(customTz || Intl.DateTimeFormat().resolvedOptions().timeZone);\n    } else {\n      setTz(value);\n      setCustomTz('');\n    }\n  };\n  \n  const handleCustomTzChange = (e) => {\n    const value = e.target.value;\n    setCustomTz(value);\n    if (value) {\n      setTz(value);\n    }\n  };\n\n  const validateForm = () => {\n    if (days.length === 0) {\n      toast.error('Please select at least one day');\n      return false;\n    }\n    if (!time) {\n      toast.error('Please select a time');\n      return false;\n    }\n    if (!tz) {\n      toast.error('Please select a timezone');\n      return false;\n    }\n    return true;\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    \n    if (!validateForm()) return;\n    \n    const formData = { \n      days, \n      time: time.padStart(5, '0'), // Ensure HH:MM format\n      tz \n    };\n    \n    // Show confirmation dialog\n    setFormData(formData);\n    lastFocusedElement.current = document.activeElement;\n    setShowConfirm(true);\n  };\n  \n  const confirmSave = async () => {\n    if (!formData) return;\n    \n    setShowConfirm(false);\n    setIsSaving(true);\n    \n    try {\n      const response = await setCadence(formData);\n      \n      if (response?.success) {\n        toast.success(response.rebuilt \n          ? \"Cadence applied & triggers rebuilt successfully!\"\n          : \"Cadence settings saved successfully!\"\n        );\n        \n        // Refresh health data\n        try {\n          const health = await getHealth();\n          if (health?.last_processed?.timestamp) {\n            setLastProcessed(new Date(health.last_processed.timestamp));\n          }\n        } catch (healthError) {\n          console.warn('Could not refresh health status:', healthError);\n        }\n      } else {\n        throw new Error(response?.error || 'Failed to save cadence settings');\n      }\n    } catch (error) {\n      console.error('Save failed:', error);\n      toast.error(`Error: ${error.message || 'Failed to save settings'}`);\n    } finally {\n      setIsSaving(false);\n      // Return focus to the last focused element\n      if (lastFocusedElement.current) {\n        lastFocusedElement.current.focus();\n      }\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-[400px]\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-gray-900\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"max-w-2xl mx-auto p-6 space-y-8\">\n      <div className=\"space-y-2\">\n        <h1 className=\"text-2xl font-bold text-gray-900\">Cadence Settings</h1>\n        <p className=\"text-gray-600\">\n          Configure when and how often the system should process proposals.\n        </p>\n      </div>\n\n      <form \n        ref={formRef}\n        onSubmit={handleSubmit} \n        className=\"space-y-6\"\n        onKeyDown={handleFormKeyDown}\n        aria-label=\"Cadence settings form\"\n      >\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Processing Days\n          </label>\n          <div className=\"flex flex-wrap gap-2\" role=\"group\" aria-label=\"Select processing days\">\n            {ALL_DAYS.map(day => {\n              const isSelected = days.includes(day);\n              return (\n                <button\n                  key={day}\n                  id={`day-${day}`}\n                  type=\"button\"\n                  onClick={() => toggleDay(day)}\n                  onKeyDown={(e) => handleDayKeyDown(day, e)}\n                  className={`px-4 py-2 rounded-md text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${\n                    isSelected\n                      ? 'bg-blue-600 text-white hover:bg-blue-700'\n                      : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'\n                  }`}\n                  role=\"checkbox\"\n                  aria-checked={isSelected}\n                  tabIndex={0}\n                >\n                  {day}\n                </button>\n              );\n            })}\n          </div>\n          <p className=\"mt-2 text-sm text-gray-500\">\n            Select days when the system should process proposals\n          </p>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div>\n            <label htmlFor=\"time\" className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Processing Time (24h)\n            </label>\n            <input\n              id=\"time\"\n              type=\"time\"\n              value={time}\n              onChange={(e) => setTime(e.target.value)}\n              className=\"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 sm:text-sm p-2 border\"\n              required\n              aria-required=\"true\"\n              aria-describedby=\"time-help\"\n            />\n            <p className=\"mt-1 text-sm text-gray-500\">\n              Time of day to process proposals\n            </p>\n          </div>\n\n          <div>\n            <label htmlFor=\"timezone\" className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Timezone\n            </label>\n            <div className=\"relative\">\n              <select\n                id=\"timezone\"\n                value={COMMON_TIMEZONES.some(tzObj => tzObj.value === tz) ? tz : 'custom'}\n                onChange={handleTimezoneChange}\n                className=\"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 sm:text-sm p-2 border\"\n                aria-describedby=\"timezone-help\"\n              >\n                <option value=\"\" disabled>Select a timezone</option>\n                {COMMON_TIMEZONES.map(tzObj => (\n                  <option key={tzObj.value} value={tzObj.value}>\n                    {tzObj.label} ({formatOffset(new Date(new Date().toLocaleString('en-US', { timeZone: tzObj.value })))})\n                  </option>\n                ))}\n                <option value=\"custom\">Custom timezone...</option>\n              </select>\n            \n            {(!COMMON_TIMEZONES.some(tzObj => tzObj.value === tz) || customTz) && (\n              <div className=\"mt-2\">\n                <div className=\"relative\">\n                  <input\n                    type=\"text\"\n                    value={customTz}\n                    onChange={handleCustomTzChange}\n                    placeholder=\"Enter IANA timezone (e.g., America/New_York)\"\n                    className=\"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 sm:text-sm p-2 border pr-10\"\n                    aria-describedby=\"timezone-help\"\n                  />\n                  {tz && !COMMON_TIMEZONES.some(tzObj => tzObj.value === tz) && (\n                    <div className=\"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none\">\n                      <span className=\"text-gray-500 text-sm\">\n                        {timezoneOffset}\n                      </span>\n                    </div>\n                  )}\n                </div>\n                {tz && (\n                  <div className=\"mt-1 flex items-center text-xs text-gray-500\">\n                    <Info className=\"w-3 h-3 mr-1 flex-shrink-0\" />\n                    <span>{getTimezoneDisplayName(tz)}</span>\n                  </div>\n                )}\n              </div>\n            )}\n            \n            <div className=\"mt-2 flex items-center text-sm text-gray-600\">\n              <Clock className=\"w-4 h-4 mr-1.5 text-gray-500 flex-shrink-0\" />\n              <span>Current time: {currentTimeInTz} {timezoneOffset}</span>\n            </div>\n            <p id=\"timezone-help\" className=\"mt-1 text-xs text-gray-500\">\n              Selected timezone will be used for all scheduled processing\n            </p>\n          </div>\n        </div>\n\n        {lastProcessed && (\n          <div className=\"text-sm text-gray-500\">\n            Last processed: {lastProcessed.toLocaleString()}\n          </div>\n        )}\n\n        <div className=\"flex justify-end space-x-3 pt-4\">\n          <button\n            type=\"button\"\n            onClick={() => window.location.reload()}\n            className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n            disabled={isSaving}\n            aria-label=\"Cancel changes and reload page\"\n          >\n            Cancel\n          </button>\n          <button\n            type=\"submit\"\n            disabled={isSaving}\n            className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n            aria-busy={isSaving}\n            aria-live=\"polite\"\n          >\n            {isSaving ? (\n              <span className=\"flex items-center\">\n                <svg className=\"animate-spin -ml-1 mr-2 h-4 w-4 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" aria-hidden=\"true\">\n                  <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                  <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                </svg>\n                <span>Saving...</span>\n              </span>\n            ) : (\n              <span>Save Settings <span className=\"text-xs opacity-70\">(Ctrl+Enter)</span></span>\n            )}\n          </button>\n        </div>\n        {/* Close any remaining section wrapper inside the form */}\n        </div>\n      </form>\n      \n      <ConfirmDialog\n        isOpen={showConfirm}\n        onConfirm={confirmSave}\n        onCancel={() => {\n          setShowConfirm(false);\n          if (lastFocusedElement.current) {\n            lastFocusedElement.current.focus();\n          }\n        }}\n        title=\"Confirm Schedule Change\"\n        message=\"Are you sure you want to update the processing schedule? This will affect when the system processes proposals.\"\n        confirmText=\"Update Schedule\"\n      />\n    </div>\n  );\n}\n"],"names":["ConfirmDialog","isOpen","onConfirm","onCancel","title","message","confirmText","cancelText","dialogRef","useRef","useEffect","handleKeyDown","e","focusable","createPortal","jsx","jsxs","AlertTriangle","ALL_DAYS","COMMON_TIMEZONES","formatOffset","date","offset","hours","minutes","getTimezoneDisplayName","timezone","commonTz","tz","options","_a","part","CadenceSettings","days","setDays","useState","time","setTime","setTz","customTz","setCustomTz","isLoading","setIsLoading","isSaving","setIsSaving","lastProcessed","setLastProcessed","currentTime","setCurrentTime","showConfirm","setShowConfirm","formData","setFormData","formRef","lastFocusedElement","timer","currentTimeInTz","useMemo","timezoneOffset","tzDate","cadence","health","getCadence","getHealth","error","toast","toggleDay","day","prev","d","a","b","handleTimezoneChange","value","handleCustomTzChange","validateForm","handleSubmit","confirmSave","response","setCadence","healthError","isSelected","tzObj","Info","Clock"],"mappings":"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"}