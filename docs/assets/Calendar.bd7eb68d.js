import{j as e,g as P,a as F}from"./main.7e5e4b3c.js";import{r as d}from"./react-vendor.36470f4f.js";import{E as S}from"./ErrorBoundary.ce0cb026.js";import{X as q,d as k}from"./ui-lib.5368d22a.js";import{t as N,c as I,i as $}from"./isValid.f1396d2d.js";import{i as M}from"./isSameDay.07bbb616.js";function O(o,a){const t=N(o);if(isNaN(a))return I(o,NaN);if(!a)return t;const i=t.getDate(),n=I(o,t.getTime());n.setMonth(t.getMonth()+a+1,0);const u=n.getDate();return i>=u?n:(t.setFullYear(n.getFullYear(),n.getMonth(),i),t)}function z(o){const a=N(o),t=a.getMonth();return a.setFullYear(a.getFullYear(),t+1,0),a.setHours(23,59,59,999),a}function H(o,a){const t=N(o.start),i=N(o.end);let n=+t>+i;const u=n?+t:+i,c=n?i:t;c.setHours(0,0,0,0);let m=(a==null?void 0:a.step)??1;if(!m)return[];m<0&&(m=-m,n=!n);const x=[];for(;+c<=u;)x.push(N(c)),c.setDate(c.getDate()+m),c.setHours(0,0,0,0);return n?x.reverse():x}function U(o){const a=N(o);return a.setDate(1),a.setHours(0,0,0,0),a}function Y(o,a){return O(o,-a)}const W=({onClose:o,onSave:a,editingEvent:t})=>{const[i,n]=d.useState((t==null?void 0:t.title)||""),[u,c]=d.useState(t?new Date(t.date).toISOString():new Date().toISOString()),[m,x]=d.useState((t==null?void 0:t.notification)||null),[h,D]=d.useState((t==null?void 0:t.type)||"custom"),[g,v]=d.useState((t==null?void 0:t.proposalId)||""),[l,w]=d.useState({}),[r,f]=d.useState(!1),[p,C]=d.useState(""),j=()=>{const s={};return i.trim()||(s.title="Title is required"),u?$(new Date(u))?new Date(u)>new Date&&(s.date="Date cannot be in the future"):s.date="Invalid date format":s.date="Date is required",h==="proposal"&&(g?/^[A-Za-z0-9-]+$/.test(g)||(s.proposalId="Proposal ID must only contain letters, numbers, and hyphens"):s.proposalId="Proposal ID is required for proposal events"),s},y=s=>{s.preventDefault();const b=j();if(Object.keys(b).length>0){w(b);return}const T={id:(t==null?void 0:t.id)||P(),title:i,date:new Date(u),type:h,proposalId:g,relatedId:t==null?void 0:t.relatedId,status:{current:"pending",progress:0,lastUpdated:new Date().toISOString()},notification:r?{enabled:!0,time:p}:null};a(T),o()};return e.jsx(S,{children:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-md",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:t?"Edit Event":"New Event"}),e.jsx("button",{onClick:o,className:"text-gray-500 hover:text-gray-700",children:e.jsx(q,{size:20})})]}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:i,onChange:s=>n(s.target.value),className:`w-full px-3 py-2 border ${l.title?"border-red-500":"border-gray-300"} rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500`,required:!0}),l.title&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx("input",{type:"date",value:u,onChange:s=>{const b=s.target.value;new Date(b)<=new Date?c(b):w({...l,date:"Date cannot be in the future"})},className:`w-full px-3 py-2 border ${l.date?"border-red-500":"border-gray-300"} rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500`,required:!0}),l.date&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),e.jsxs("select",{value:h,onChange:s=>D(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"custom",children:"Custom Event"}),e.jsx("option",{value:"proposal",children:"Proposal"}),e.jsx("option",{value:"task",children:"Task"})]})]}),h==="proposal"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Proposal ID"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:g,onChange:s=>v(s.target.value),className:`w-full px-3 py-2 border ${l.proposalId?"border-red-500":"border-gray-300"} rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"e.g., PROJ-123"}),l.proposalId&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.proposalId})]})]}),e.jsx("div",{children:e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx("input",{id:"push-notification",type:"checkbox",checked:r,onChange:s=>{f(s.target.checked),s.target.checked&&x({enabled:!0,time:p||new Date().toISOString()})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2"}),e.jsx("span",{children:"Enable Push Notification"})]})}),r&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notification Time"}),e.jsx("input",{type:"datetime-local",value:p,onChange:s=>{C(s.target.value),m&&x(b=>({...b,time:s.target.value}))},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),r&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label",htmlFor:"notification-time",children:"Notification Time"}),e.jsx("input",{id:"notification-time",className:"form-input",type:"datetime-local",value:p,onChange:s=>C(s.target.value),required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:Object.keys(l).length>0,className:`px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${Object.keys(l).length>0?"bg-gray-400 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"}`,children:[t?"Update":"Create"," Event"]})]})]})]})})})})},_=()=>{const{proposals:o,customEvents:a,addCustomEvent:t,updateCustomEvent:i,deleteCustomEvent:n}=F(),[u,c]=d.useState(!1),[m,x]=d.useState(void 0),[h,D]=d.useState(new Date),g=d.useMemo(()=>{const r=U(h),f=z(h),p=new Date(r),C=new Date(f),j=new Date(p);j.setDate(j.getDate()-j.getDay());const y=new Date(C);return y.setDate(y.getDate()+(6-y.getDay())),H({start:j,end:y})},[h]),v=r=>{D(r==="prev"?Y(h,1):O(h,1))},l=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],w=r=>{c(!0),x(void 0)};return e.jsx(S,{children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Calendar"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:()=>v("prev"),className:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300",children:"Previous Month"}),e.jsx("button",{onClick:()=>v("next"),className:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300",children:"Next Month"})]})]}),e.jsx("div",{className:"grid grid-cols-7 gap-4 mb-8",children:l.map(r=>e.jsx("div",{className:"text-center font-semibold text-gray-600",children:r},r))}),e.jsx("div",{className:"grid grid-cols-7 gap-4",children:g.map(r=>e.jsxs("div",{className:`p-4 rounded-lg ${M(r,new Date)?"bg-blue-50":""} cursor-pointer hover:bg-gray-50 transition-colors duration-200`,onClick:()=>w(),children:[e.jsx("div",{className:"text-center mb-4",children:e.jsx("span",{className:"font-semibold",children:r.getDate()})}),a.length>0?e.jsx(S,{children:a.map(f=>e.jsx("div",{children:M(f.date,r)&&e.jsxs("div",{className:"flex justify-between items-center gap-2",children:[e.jsx("span",{className:"text-blue-600 truncate max-w-[120px]",children:f.title}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:p=>{p.stopPropagation(),x(f),c(!0)},className:"p-1 hover:bg-blue-100 rounded-full transition-colors duration-200",title:"Edit",children:e.jsx(k,{size:16,className:"text-blue-600"})}),e.jsx("button",{onClick:p=>{p.stopPropagation(),n(f.id)},className:"p-1 hover:bg-red-100 rounded-full transition-colors duration-200",title:"Delete",children:e.jsx(k,{size:16,className:"text-red-600"})})]})]})},f.id))}):e.jsx("div",{className:"text-gray-400 text-sm mt-2",children:"No events scheduled"})]},r.toISOString()))}),u&&e.jsx(W,{onClose:()=>{c(!1),x(void 0)},onSave:r=>{m?i(r):t(r),c(!1)},editingEvent:m})]})})},Z=_;export{Z as default};
//# sourceMappingURL=Calendar.bd7eb68d.js.map
